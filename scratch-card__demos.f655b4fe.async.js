(self.webpackChunkscratch_card_react=self.webpackChunkscratch_card_react||[]).push([[779],{6302:function(v,C,e){"use strict";e.r(C);var h=e(88053),s=e(18733),r=e(11527),a="https://images.unsplash.com/photo-1567945716310-4745a6b7844b?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=1500&q=60";C.default=function(){return(0,r.jsxs)("div",{children:[(0,r.jsx)(s.P,{title:"\u57FA\u672C\u5C55\u793A\uFF0C\u4F1A\u6709\u9ED8\u8BA4\u5BBD\u9AD8\u548C\u989C\u8272",children:(0,r.jsx)(h.K,{})}),(0,r.jsx)(s.P,{title:"\u8BBE\u7F6E\u5BBD\u9AD8\u548C\u9EC4\u8272\u8499\u7248\u4E0E\u5E95\u90E8\u5143\u7D20",children:(0,r.jsx)(h.K,{classNames:{root:"customize-root",mask:"customize-mask",body:"customize-body"},width:260,height:180,coverColor:"yellow",children:(0,r.jsx)(s.Q,{})})}),(0,r.jsx)(s.P,{title:"\u8BBE\u7F6E\u8499\u7248\u4E3A\u56FE\u7247",children:(0,r.jsx)(h.K,{width:300,height:200,coverImg:a,children:(0,r.jsx)(s.Q,{})})})]})}},69352:function(v,C,e){"use strict";e.r(C);var h=e(50959),s=e(88053),r=e(18733),a=e(11527),f="https://images.unsplash.com/photo-1620476214170-1d8080f65cdb?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=3150&q=80";C.default=function(){var l=(0,h.useRef)(null);return(0,a.jsxs)("div",{children:[(0,a.jsx)(r.P,{title:"\u522E\u5F00\u4E00\u5B9A\u6BD4\u4F8B\u56FE\u5C42\u89E6\u53D1\u56DE\u8C03",children:(0,a.jsx)(s.K,{width:260,height:180,coverColor:"skyblue",callbackInfo:{radio:.8,calllback:function(){alert("scratch done")}},children:(0,a.jsx)(r.Q,{})})}),(0,a.jsxs)(r.P,{title:"\u5B8C\u6574\u529F\u80FD\uFF0C\u652F\u6301ref\u6E05\u9664\u8499\u5C42",children:[(0,a.jsx)(s.K,{ref:l,width:300,height:200,coverImg:f,callbackInfo:{radio:.8,calllback:function(){alert("scratch done")}},children:(0,a.jsx)(r.Q,{style:{backgroundColor:"red"}})}),(0,a.jsx)("button",{style:{marginTop:10},onClick:function(){var x;(x=l.current)===null||x===void 0||x.clearCard()},children:"\u6E05\u9664\u8499\u5C42"})]})]})}},88053:function(v,C,e){"use strict";e.d(C,{K:function(){return Y}});var h=e(28152),s=e.n(h),r=e(95530),a=e.n(r),f=e(77117),l=e.n(f),o=e(84875),x=e.n(o),p=e(50959),k=e(13448),M=e.n(k),S=e(74815),K=e.n(S);function U(b){return new Promise(function(d,i){var m=new Image;m.src=b,m.setAttribute("crossOrigin",""),m.onload=function(){return d(m)},m.onerror=i})}function H(b){return L.apply(this,arguments)}function L(){return L=K()(M()().mark(function b(d){var i;return M()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(d instanceof Promise)){n.next=7;break}return n.next=3,d;case 3:return i=n.sent,n.abrupt("return",i.default);case 7:return n.abrupt("return",d);case 8:case"end":return n.stop()}},b)})),L.apply(this,arguments)}var N=function(d){var i=d.canvasRef,m=d.width,n=d.height,W=d.coverColor,y=d.coverImg,g=d.callbackInfo,B=(0,p.useRef)(!1),_=(0,p.useState)(!1),A=s()(_,2),V=A[0],X=A[1];(0,p.useEffect)(function(){return $(),function(){T()}},[]);var $=function(){var I=K()(M()().mark(function u(){var t,c,D,P;return M()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if(t=i.current,t){E.next=3;break}return E.abrupt("return");case 3:if(t.width=m,t.height=n,c=t==null?void 0:t.getContext("2d"),c){E.next=8;break}return E.abrupt("return");case 8:if(!y){E.next=18;break}return E.next=11,H(y);case 11:return D=E.sent,E.next=14,U(D);case 14:P=E.sent,c.drawImage(P,0,0,m,n),E.next=20;break;case 18:c.fillStyle=W,c.fillRect(0,0,t.width,t.height);case 20:c.globalCompositeOperation="destination-out",t.addEventListener("mousedown",j.bind(null,!0)),t.addEventListener("touchstart",j.bind(null,!0)),t.addEventListener("mousemove",R),t.addEventListener("touchmove",R),t.addEventListener("mouseup",j.bind(null,!1)),t.addEventListener("touchend",j.bind(null,!1)),X(!0);case 28:case"end":return E.stop()}},u)}));return function(){return I.apply(this,arguments)}}(),T=function(){var u=i.current;u&&(u.removeEventListener("mousedown",j.bind(null,!0)),u.removeEventListener("touchstart",j.bind(null,!0)),u.removeEventListener("mousemove",R),u.removeEventListener("touchmove",R),u.removeEventListener("mouseup",j.bind(null,!1)),u.removeEventListener("touchend",j.bind(null,!1)))},J=function(){var u=i.current;if(u){var t=u.getContext("2d");t&&(t.clearRect(0,0,m,n),T())}},R=function(u){if(B.current){u.preventDefault();var t=i.current;if(t){var c=t.getContext("2d");if(c){var D=t.getClientRects()[0],P=u.clientX-D.x,O=u.clientY-D.y;c.beginPath(),c.arc(P,O,20,0,Math.PI*2),c.fill(),typeof(g==null?void 0:g.calllback)=="function"&&Z(c)}}}},Z=function(u){for(var t=u.getImageData(0,0,m,n),c=[],D=0;D<t.data.length;D++){var P=t.data[D+3];P===0&&c.push(P)}if(c.length/t.data.length>((g==null?void 0:g.radio)||.8)){var O;g==null||(O=g.calllback)===null||O===void 0||O.call(g)}},j=function(u){B.current=u};return[B.current,V,J]},q=null,w=e(11527),G=["children","classNames"],F="scratch-card",Q={width:240,height:120,coverColor:"#ddd"},z=(0,p.forwardRef)(function(b,d){var i=l()(l()({},Q),b),m=i.children,n=i.classNames,W=a()(i,G),y=(0,p.useRef)(null),g=N(l()({canvasRef:y},W)),B=s()(g,3),_=B[1],A=B[2];return(0,p.useImperativeHandle)(d,function(){return{canvasContainer:y.current,initDone:_,clearCard:A}}),(0,w.jsxs)("div",{className:x()(F,n==null?void 0:n.root),style:{width:i.width,height:i.height},children:[(0,w.jsx)("canvas",{ref:y,className:x()("".concat(F,"-mask"),n==null?void 0:n.mask)}),(0,w.jsx)("div",{className:x()("".concat(F,"-container"),n==null?void 0:n.body),style:{width:i.width,height:i.height},children:_&&m})]})}),Y=z},18733:function(v,C,e){"use strict";e.d(C,{P:function(){return a},Q:function(){return f}});var h=e(77117),s=e.n(h),r=e(11527),a=function(o){return(0,r.jsxs)("div",{style:{marginTop:20},children:[(0,r.jsx)("p",{children:o.title}),o.children]})},f=function(o){return(0,r.jsx)("div",{style:s()({width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},o.style),children:(0,r.jsx)("span",{children:"\u606D\u559C\u60A8\uFF0C\u522E\u4E2D\u4E86\u6CD5\u62C9\u52295\u5143\u4EE3\u91D1\u52B5"})})}},95530:function(v,C,e){var h=e(70285);function s(r,a){if(r==null)return{};var f=h(r,a),l,o;if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(r);for(o=0;o<x.length;o++)l=x[o],!(a.indexOf(l)>=0)&&Object.prototype.propertyIsEnumerable.call(r,l)&&(f[l]=r[l])}return f}v.exports=s,v.exports.__esModule=!0,v.exports.default=v.exports},70285:function(v){function C(e,h){if(e==null)return{};var s={},r=Object.keys(e),a,f;for(f=0;f<r.length;f++)a=r[f],!(h.indexOf(a)>=0)&&(s[a]=e[a]);return s}v.exports=C,v.exports.__esModule=!0,v.exports.default=v.exports}}]);
