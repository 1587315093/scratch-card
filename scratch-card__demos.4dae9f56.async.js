(self.webpackChunkscratch_card_react=self.webpackChunkscratch_card_react||[]).push([[779],{59751:function(h,C,e){"use strict";e.r(C);var f=e(88053),s=e(18733),r=e(11527);C.default=function(){return(0,r.jsxs)("div",{children:[(0,r.jsx)(s.P,{title:"\u57FA\u672C\u5C55\u793A\uFF0C\u4F1A\u6709\u9ED8\u8BA4\u5BBD\u9AD8\u548C\u989C\u8272",children:(0,r.jsx)(f.K,{})}),(0,r.jsx)(s.P,{title:"\u8BBE\u7F6E\u5BBD\u9AD8\u548C\u9EC4\u8272\u8499\u7248\u4E0E\u5E95\u90E8\u5143\u7D20",children:(0,r.jsx)(f.K,{classNames:{root:"customize-root",mask:"customize-mask",body:"customize-body"},width:260,height:180,coverColor:"yellow",children:(0,r.jsx)(s.Q,{})})}),(0,r.jsx)(s.P,{title:"\u8BBE\u7F6E\u8499\u7248\u4E3A\u56FE\u7247",children:(0,r.jsx)(f.K,{width:260,height:226,coverImg:"https://zos.alipayobjects.com/rmsportal/jkjgkEfvpUPVyRjUImniVslZfWPnJuuZ.png",children:(0,r.jsx)(s.Q,{})})})]})}},41373:function(h,C,e){"use strict";e.r(C);var f=e(50959),s=e(88053),r=e(18733),u=e(11527);C.default=function(){var o=(0,f.useRef)(null);return(0,u.jsxs)("div",{children:[(0,u.jsx)(r.P,{title:"\u522E\u5F00\u4E00\u5B9A\u6BD4\u4F8B\u56FE\u5C42\u89E6\u53D1\u56DE\u8C03",children:(0,u.jsx)(s.K,{width:260,height:180,coverColor:"skyblue",callbackInfo:{radio:.8,calllback:function(){alert("scratch done")}},children:(0,u.jsx)(r.Q,{})})}),(0,u.jsxs)(r.P,{title:"\u5B8C\u6574\u529F\u80FD\uFF0C\u652F\u6301ref\u6E05\u9664\u8499\u5C42",children:[(0,u.jsx)(s.K,{ref:o,width:260,height:226,coverImg:"https://zos.alipayobjects.com/rmsportal/jkjgkEfvpUPVyRjUImniVslZfWPnJuuZ.png",callbackInfo:{radio:.8,calllback:function(){alert("scratch done")}},children:(0,u.jsx)(r.Q,{style:{backgroundColor:"red"}})}),(0,u.jsx)("button",{style:{marginTop:10},onClick:function(){var l;(l=o.current)===null||l===void 0||l.clearCard()},children:"\u6E05\u9664\u8499\u5C42"})]})]})}},88053:function(h,C,e){"use strict";e.d(C,{K:function(){return G}});var f=e(28152),s=e.n(f),r=e(95530),u=e.n(r),o=e(77117),d=e.n(o),l=e(84875),x=e.n(l),y=e(50959),U=e(13448),_=e.n(U),S=e(74815),K=e.n(S);function w(D){return new Promise(function(v,i){var m=new Image;m.src=D,m.setAttribute("crossOrigin",""),m.onload=function(){return v(m)},m.onerror=i})}function N(D){return M.apply(this,arguments)}function M(){return M=K()(_()().mark(function D(v){var i;return _()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(v instanceof Promise)){n.next=7;break}return n.next=3,v;case 3:return i=n.sent,n.abrupt("return",i.default);case 7:return n.abrupt("return",v);case 8:case"end":return n.stop()}},D)})),M.apply(this,arguments)}var z=function(v){var i=v.canvasRef,m=v.width,n=v.height,W=v.coverColor,b=v.coverImg,g=v.callbackInfo,I=(0,y.useRef)(!1),B=(0,y.useState)(!1),A=s()(B,2),J=A[0],H=A[1];(0,y.useEffect)(function(){return X(),function(){T()}},[]);var X=function(){var O=K()(_()().mark(function a(){var t,c,j,p;return _()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if(t=i.current,t){E.next=3;break}return E.abrupt("return");case 3:if(t.width=m,t.height=n,c=t==null?void 0:t.getContext("2d"),c){E.next=8;break}return E.abrupt("return");case 8:if(!b){E.next=18;break}return E.next=11,N(b);case 11:return j=E.sent,E.next=14,w(j);case 14:p=E.sent,c.drawImage(p,0,0,m,n),E.next=20;break;case 18:c.fillStyle=W,c.fillRect(0,0,t.width,t.height);case 20:c.globalCompositeOperation="destination-out",t.addEventListener("mousedown",P.bind(null,!0)),t.addEventListener("touchstart",P.bind(null,!0)),t.addEventListener("mousemove",L),t.addEventListener("touchmove",L),t.addEventListener("mouseup",P.bind(null,!1)),t.addEventListener("touchend",P.bind(null,!1)),H(!0);case 28:case"end":return E.stop()}},a)}));return function(){return O.apply(this,arguments)}}(),T=function(){var a=i.current;a&&(a.removeEventListener("mousedown",P.bind(null,!0)),a.removeEventListener("touchstart",P.bind(null,!0)),a.removeEventListener("mousemove",L),a.removeEventListener("touchmove",L),a.removeEventListener("mouseup",P.bind(null,!1)),a.removeEventListener("touchend",P.bind(null,!1)))},Y=function(){var a=i.current;if(a){var t=a.getContext("2d");t&&(t.clearRect(0,0,m,n),T())}},L=function(a){if(I.current){a.preventDefault();var t=i.current;if(t){var c=t.getContext("2d");if(c){var j=t.getClientRects()[0],p=a.clientX-j.x,R=a.clientY-j.y;c.beginPath(),c.arc(p,R,20,0,Math.PI*2),c.fill(),typeof(g==null?void 0:g.calllback)=="function"&&$(c)}}}},$=function(a){for(var t=a.getImageData(0,0,m,n),c=[],j=0;j<t.data.length;j++){var p=t.data[j+3];p===0&&c.push(p)}if(c.length/t.data.length>((g==null?void 0:g.radio)||.8)){var R;g==null||(R=g.calllback)===null||R===void 0||R.call(g)}},P=function(a){I.current=a};return[I.current,J,Y]},q=null,k=e(11527),Q=["children","classNames"],F="scratch-card",V={width:240,height:120,coverColor:"#ddd"},Z=(0,y.forwardRef)(function(D,v){var i=d()(d()({},V),D),m=i.children,n=i.classNames,W=u()(i,Q),b=(0,y.useRef)(null),g=z(d()({canvasRef:b},W)),I=s()(g,3),B=I[1],A=I[2];return(0,y.useImperativeHandle)(v,function(){return{canvasContainer:b.current,initDone:B,clearCard:A}}),(0,k.jsxs)("div",{className:x()(F,n==null?void 0:n.root),style:{width:i.width,height:i.height},children:[(0,k.jsx)("canvas",{ref:b,className:x()("".concat(F,"-mask"),n==null?void 0:n.mask)}),(0,k.jsx)("div",{className:x()("".concat(F,"-container"),n==null?void 0:n.body),style:{width:i.width,height:i.height},children:B&&m})]})}),G=Z},18733:function(h,C,e){"use strict";e.d(C,{P:function(){return u},Q:function(){return o}});var f=e(77117),s=e.n(f),r=e(11527),u=function(l){return(0,r.jsxs)("div",{style:{marginTop:20},children:[(0,r.jsx)("p",{children:l.title}),l.children]})},o=function(l){return(0,r.jsx)("div",{style:s()({width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},l.style),children:(0,r.jsx)("span",{children:"\u606D\u559C\u60A8\uFF0C\u522E\u4E2D\u4E86\u6CD5\u62C9\u52295\u5143\u4EE3\u91D1\u52B5"})})}},95530:function(h,C,e){var f=e(70285);function s(r,u){if(r==null)return{};var o=f(r,u),d,l;if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(r);for(l=0;l<x.length;l++)d=x[l],!(u.indexOf(d)>=0)&&Object.prototype.propertyIsEnumerable.call(r,d)&&(o[d]=r[d])}return o}h.exports=s,h.exports.__esModule=!0,h.exports.default=h.exports},70285:function(h){function C(e,f){if(e==null)return{};var s={},r=Object.keys(e),u,o;for(o=0;o<r.length;o++)u=r[o],!(f.indexOf(u)>=0)&&(s[u]=e[u]);return s}h.exports=C,h.exports.__esModule=!0,h.exports.default=h.exports}}]);
